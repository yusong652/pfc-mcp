{
  "command": "contact property",
  "category": "contact",
  "search_keywords": [
    "property",
    "stiffness",
    "friction",
    "damping"
  ],
  "description": "Assign contact properties to existing contacts. All contacts with a contact model that recognizes the specified property are affected. This command modifies properties of existing contacts directly, unlike CMAT commands which define rules for future contact creation. Property inheritance may also be modified with the optional 'inheritance' keyword. By default, only mechanical contacts are considered.",
  "syntax": "contact property <keyword> ... <inheritance b> ... <range>",
  "keywords": [
    {
      "name": "mechanical",
      "syntax": "mechanical",
      "description": "Apply to mechanical contacts (default behavior)"
    },
    {
      "name": "thermal",
      "syntax": "thermal",
      "description": "Apply to thermal contacts (instead of mechanical)"
    },
    {
      "name": "inheritance",
      "syntax": "inheritance <b>",
      "description": "Set property inheritance flag",
      "parameters": [
        {
          "name": "b",
          "type": "boolean",
          "description": "true to enable inheritance, false to disable"
        }
      ],
      "notes": "Only applicable to inheritable properties. Not all properties support inheritance."
    }
  ],
  "applicable_contact_models": [
    "linear",
    "linearpbond",
    "linearcbond",
    "hertz",
    "rrlinear",
    "arrlinear",
    "lineardipole",
    "burger",
    "spring network",
    "Johnson-Kendall-Roberts",
    "Edinburgh-Elasto-Plastic-Adhesive",
    "hysteretic",
    "smoothjoint",
    "flatjoint",
    "fish",
    "bilinear",
    "softbond"
  ],
  "examples": [
    {
      "command": "contact property pb_kn 1e7 pb_ks 1e7 pb_ten 4e5 pb_coh 4e5 pb_fa 20.0",
      "description": "Set parallel bond properties for all contacts with linearpbond model (from fragmentation analysis example)",
      "model": "linearpbond"
    },
    {
      "command": "contact property lin_mode 1 lin_force 0 0 0 pb_ten 2e5 pb_coh 2e6",
      "description": "Set linear mode, reset force, and update bond strengths (from sleeved triaxial test)",
      "model": "linearpbond"
    },
    {
      "command": "contact property pb_ten 1e5 pb_coh 1e5 pb_kn 500 pb_ks 188 pb_rmul 0.8",
      "description": "Set bond properties including radius multiplier (from cantilever beam example)",
      "model": "linearpbond"
    },
    {
      "command": "contact property kn 1e8 ks 5e7 fric 0.5",
      "description": "Update stiffnesses and friction for all contacts with linear model",
      "model": "linear"
    },
    {
      "command": "contact property fric 0.6 range group 'soil'",
      "description": "Change friction coefficient only for contacts in 'soil' group",
      "model": "any"
    },
    {
      "command": "contact property dp_nratio 0.7 dp_sratio 0.5",
      "description": "Add/update damping ratios for contacts with dashpot properties",
      "model": "linear, linearpbond, linearcbond, etc."
    },
    {
      "command": "contact property hz_shear 2e9 hz_poiss 0.25 range contact type 'ball-ball'",
      "description": "Update Hertz model material properties for ball-ball contacts",
      "model": "hertz"
    },
    {
      "command": "contact property rr_fric 0.3 range contact",
      "description": "Set rolling friction coefficient for all contacts with rrlinear model",
      "model": "rrlinear"
    },
    {
      "command": "contact property kn 1e8 inheritance true",
      "description": "Set normal stiffness and enable inheritance from contacting pieces",
      "model": "linear, linearpbond, linearcbond"
    }
  ],
  "python_sdk_alternative": {
    "available": true,
    "methods": [
      {
        "signature": "contact.set_prop(property_name, value)",
        "description": "Set a single property value on a contact object",
        "example": "for c in it.contact.list(): c.set_prop('kn', 1e8)"
      },
      {
        "signature": "contact.prop(property_name)",
        "description": "Get current property value",
        "example": "kn_value = contact.prop('kn')"
      }
    ],
    "notes": [
      "Python SDK requires iteration over contacts - cannot set properties for all contacts in one call",
      "Command interface is more efficient for bulk property updates",
      "Use range specification in command interface to avoid iterating in Python"
    ]
  },
  "model_properties_reference": {
    "path": "model-properties/index.json",
    "description": "For comprehensive property information for each contact model, see the model-properties reference documentation",
    "quick_links": {
      "linear": "model-properties/linear.json",
      "linearcbond": "model-properties/linearcbond.json",
      "linearpbond": "model-properties/linearpbond.json",
      "hertz": "model-properties/hertz.json",
      "rrlinear": "model-properties/rrlinear.json"
    },
    "note": "Property documentation includes types, ranges, defaults, inheritance info, and usage notes"
  },
  "related_commands": [
    "contact cmat add",
    "contact cmat default",
    "contact cmat apply",
    "contact model assign"
  ],
  "notes": [
    "Affects EXISTING contacts, not future contact creation (unlike CMAT commands)",
    "Only contacts whose model recognizes the property are affected",
    "Multiple properties can be set in a single command",
    "Property names are model-specific - see model-properties documentation",
    "Contacts that don't have the specified property are silently ignored",
    "Use range specification to target specific contacts",
    "Inheritance keyword only works with inheritable properties",
    "Changes take effect immediately - no need to apply",
    "More efficient than Python iteration for bulk updates"
  ],
  "property_vs_cmat": {
    "contact_property": {
      "target": "EXISTING contacts",
      "timing": "After contacts are created",
      "scope": "Modifies current state",
      "use_case": "Adjust properties during simulation or after calibration",
      "example": "contact property pb_ten 2e5 range group 'soil'"
    },
    "contact_cmat": {
      "target": "FUTURE contacts (rules)",
      "timing": "Before contacts are created",
      "scope": "Defines creation rules",
      "use_case": "Set default behavior for contact creation",
      "example": "contact cmat add model linearpbond property pb_ten 2e5 range group 'soil'"
    },
    "both_needed": "Use CMAT to configure initial contact behavior, then use 'contact property' to adjust properties during simulation or after calibration"
  },
  "common_use_cases": [
    {
      "use_case": "Update bond strengths after calibration",
      "workflow": [
        "1. Run initial simulation with default bond properties",
        "2. Calibrate against experimental data",
        "3. Use 'contact property' to update strengths: contact property pb_ten 2e5 pb_coh 3e5",
        "4. Continue simulation with calibrated values"
      ]
    },
    {
      "use_case": "Add damping to existing simulation",
      "workflow": [
        "1. Simulation running with no damping",
        "2. Add damping for quasi-static behavior: contact property dp_nratio 0.7 dp_mode 1",
        "3. Damping immediately affects all contacts"
      ]
    },
    {
      "use_case": "Modify specific contact group",
      "workflow": [
        "1. Identify target contacts: contact list range group 'foundation'",
        "2. Update properties: contact property kn 5e8 ks 2e8 range group 'foundation'",
        "3. Other contacts remain unchanged"
      ]
    },
    {
      "use_case": "Reset forces (troubleshooting)",
      "workflow": [
        "1. Simulation has accumulated residual forces",
        "2. Reset linear forces: contact property lin_force 0 0 0",
        "3. Or reset parallel bond forces: contact property pb_force 0 0 0 pb_moment 0 0 0"
      ]
    },
    {
      "use_case": "Change material properties (Hertz model)",
      "workflow": [
        "1. Initial simulation with estimated properties",
        "2. Update based on material testing: contact property hz_shear 2.5e9 hz_poiss 0.28",
        "3. Properties updated for all Hertz contacts"
      ]
    }
  ],
  "property_inheritance": {
    "concept": "Some properties can inherit values from the contacting pieces (balls, walls). When inheritance is enabled, the property value is calculated from the piece properties rather than being set directly.",
    "inheritable_properties": [
      "kn (normal stiffness)",
      "ks (shear stiffness)",
      "fric (friction coefficient)",
      "hz_shear (shear modulus)",
      "hz_poiss (Poisson's ratio)",
      "rr_fric (rolling friction)"
    ],
    "non_inheritable_properties": [
      "rgap (reference gap)",
      "lin_mode (normal-force update mode)",
      "dp_nratio (damping ratio)",
      "pb_ten (bond tensile strength)",
      "pb_coh (bond cohesion)"
    ],
    "usage": "contact property kn 1e8 inheritance true",
    "notes": [
      "Only works with properties that support inheritance",
      "Inheritance rules depend on contact model (e.g., minimum, average, harmonic mean)",
      "See model-properties documentation for which properties are inheritable"
    ]
  },
  "typical_workflow": [
    "1. Check current property values using contact list or Python",
    "2. Identify contacts to modify (use range if needed)",
    "3. Execute 'contact property' with new values",
    "4. Verify changes (optional): list properties or query specific contacts",
    "5. Continue simulation - changes take effect immediately"
  ],
  "performance_considerations": {
    "command_interface": "Very fast - bulk update in C++ core",
    "python_iteration": "Slower - Python loop overhead",
    "recommendation": "Use command interface for bulk updates, Python for selective/conditional updates",
    "example_comparison": [
      {
        "approach": "Command",
        "code": "itasca.command('contact property kn 1e8')",
        "speed": "Fast - single operation"
      },
      {
        "approach": "Python loop",
        "code": "for c in it.contact.list(): c.set_prop('kn', 1e8)",
        "speed": "Slower - iteration overhead"
      }
    ]
  },
  "range_specifications": {
    "description": "Range limits which contacts are affected by the property command",
    "common_ranges": {
      "contact": "All contacts",
      "group <name>": "Contacts in specified group",
      "type <type>": "Contacts of specific type (ball-ball, ball-facet, etc.)",
      "model <model>": "Contacts with specific contact model",
      "id <id1> <id2>": "Specific contact between two objects"
    },
    "examples": [
      "contact property kn 1e8 range group 'soil'",
      "contact property fric 0.5 range contact type 'ball-ball'",
      "contact property pb_ten 2e5 range model linearpbond"
    ]
  },
  "troubleshooting": [
    {
      "issue": "Property not changing",
      "solutions": [
        "Check if contact model recognizes the property (e.g., can't set 'pb_kn' on linear model)",
        "Verify range specification targets correct contacts",
        "Check if property is read-only (some properties cannot be set directly)"
      ]
    },
    {
      "issue": "Some contacts not affected",
      "solutions": [
        "Property is model-specific - contacts with different models won't be affected",
        "Use range specification if you need to target specific contacts",
        "Use 'contact list' to verify contact models"
      ]
    },
    {
      "issue": "Inheritance not working",
      "solutions": [
        "Property may not support inheritance - check model-properties documentation",
        "Inheritance keyword syntax: 'property <name> <value> inheritance <true/false>'",
        "Only inheritable properties respond to inheritance keyword"
      ]
    },
    {
      "issue": "Want to update properties for contacts to be created",
      "solutions": [
        "Use 'contact cmat' commands instead - 'contact property' only affects existing contacts",
        "Or use 'contact property' after contacts are created"
      ]
    }
  ],
  "warnings": [
    {
      "type": "model_compatibility",
      "message": "Setting properties not recognized by a contact's model has no effect",
      "example": "Setting 'pb_kn' on contacts with linear model does nothing"
    },
    {
      "type": "immediate_effect",
      "message": "Property changes take effect immediately - may cause sudden force changes",
      "mitigation": "Consider ramping property changes gradually for stability"
    },
    {
      "type": "read_only_properties",
      "message": "Some properties are calculated automatically and cannot be set directly",
      "examples": [
        "pb_sigma (normal stress)",
        "pb_tau (shear stress)",
        "hz_slip (slip state)"
      ]
    }
  ]
}
