{
  "command": "wall tolerance",
  "category": "wall",
  "search_keywords": [
    "tolerance",
    "contact-detection"
  ],
  "description": "Set contact detection tolerances. The size of the extent with which a facet is inserted into the cell space is the minimum extent size plus twice the sum of: 1) maximum interaction distance; 2) constant contact-detection tolerance (constant - default 0); 3) maximum length of minimum extent multiplied by extent tolerance (extent - default 10⁻⁶); 4) maximum translational velocity component multiplied by velocity tolerance (velocity - default 0). The facet is remapped into cell space whenever it has translated cumulatively by this sum from last mapping. Contacts can be created whenever expanded extents of any pieces (balls, clump pebbles, or facets) overlap, but contacts cannot exist between facets. Note: Directly after model restore, must call 'model clean' prior to modifying extent tolerances.",
  "syntax": "wall tolerance <keyword> ...",
  "keywords": [
    {
      "name": "automatic",
      "syntax": "automatic <b>",
      "description": "Change automatic tolerance computation mode (on by default). When true, determines wall facet controlling timestep and sets velocity tolerance so timestep not reduced from last stable timestep. Useful when few facets are moving"
    },
    {
      "name": "constant",
      "syntax": "constant <f> <range>",
      "description": "Assign constant contact-detection tolerance. Assigned per-facet. Default: 0"
    },
    {
      "name": "extent",
      "syntax": "extent <f>",
      "description": "Assign extent contact-detection tolerance. Global setting for all facets. Default: 10⁻⁶"
    },
    {
      "name": "velocity",
      "syntax": "velocity <f>",
      "description": "Assign velocity contact-detection tolerance. Global setting for all facets. Default: 0"
    }
  ],
  "tolerance_calculation": {
    "description": "Facet extent size in cell space",
    "formula": "extent = min_extent + 2 * (max_interaction_dist + tol_constant + max_extent_length * tol_extent + max_velocity * tol_velocity)",
    "components": [
      {
        "name": "min_extent",
        "description": "Minimum extent size of facet"
      },
      {
        "name": "max_interaction_dist",
        "description": "Maximum interaction distance"
      },
      {
        "name": "tol_constant",
        "description": "Constant tolerance (default 0, per-facet)"
      },
      {
        "name": "tol_extent",
        "description": "Extent tolerance (default 10⁻⁶, global)"
      },
      {
        "name": "tol_velocity",
        "description": "Velocity tolerance (default 0, global)"
      }
    ]
  },
  "important_notes": [
    "Must call 'model clean' after model restore before modifying extent tolerances",
    "Facet remapped when cumulative translation exceeds tolerance sum",
    "Contacts created when expanded extents overlap",
    "Contacts CANNOT exist between facets (only ball-facet, pebble-facet)",
    "Automatic mode prevents timestep reduction when few facets are moving",
    "Constant tolerance is per-facet, extent and velocity are global"
  ],
  "use_cases": [
    {
      "use_case": "Fast-moving walls",
      "description": "Increase velocity tolerance to reduce remapping frequency, but ensure contacts are still detected"
    },
    {
      "use_case": "Fine contact detection",
      "description": "Decrease extent tolerance for more precise contact detection in critical regions"
    },
    {
      "use_case": "Performance optimization",
      "description": "Use automatic mode to prevent timestep reduction when only few walls are moving"
    },
    {
      "use_case": "Specific facet tolerance",
      "description": "Set constant tolerance per-facet for walls requiring different detection sensitivity"
    }
  ],
  "examples": [
    {
      "command": "wall tolerance automatic true",
      "description": "Enable automatic tolerance computation (default, prevents timestep reduction)"
    },
    {
      "command": "wall tolerance automatic false",
      "description": "Disable automatic tolerance computation"
    },
    {
      "command": "wall tolerance extent 1e-5",
      "description": "Set global extent tolerance to 1e-5 (10x default)"
    },
    {
      "command": "wall tolerance velocity 0.1",
      "description": "Set global velocity tolerance to 0.1 for fast-moving walls"
    },
    {
      "command": "wall tolerance constant 0.01 range name 'platen'",
      "description": "Set constant tolerance to 0.01 for facets in wall named 'platen'"
    },
    {
      "command": "wall tolerance constant 0.005 range id 1 10",
      "description": "Set per-facet constant tolerance for walls with IDs 1-10"
    }
  ],
  "python_sdk_alternative": {
    "available": false,
    "workaround": "itasca.command('wall tolerance ...') - Python SDK does not provide contact detection tolerance settings. This is a low-level algorithmic control"
  }
}
