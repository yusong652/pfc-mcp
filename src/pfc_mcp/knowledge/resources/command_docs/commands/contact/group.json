{
  "command": "contact group",
  "category": "contact",
  "search_keywords": [
    "group",
    "assign"
  ],
  "description": "Assign group names to contacts for organization and range-based selection. Groups are a fundamental organizational tool in PFC, allowing contacts to be categorized, selected, and manipulated based on group membership. Contacts can belong to multiple groups via different slots. By default, the group name is assigned to the 'Default' slot. Use 'slot' keyword to specify a particular slot. By default, only mechanical contacts are considered. IMPORTANT: The 'add' and 'remove' keywords apply to ALL contacts (or a previously active range), they cannot be combined with a 'range' keyword in the same command.",
  "syntax": "contact group <s> <keyword> ... <range>",
  "keywords": [
    {
      "name": "slot",
      "syntax": "slot <slot>",
      "description": "Specify which group slot to use for assignment. By default, uses slot 'Default'. Can be combined with range",
      "parameters": [
        {
          "name": "slot",
          "type": "string",
          "description": "Slot name (e.g., 'Default', 'boundary', 'region', etc.)"
        }
      ]
    },
    {
      "name": "add",
      "syntax": "add",
      "description": "Assign group name to the next available slot for ALL contacts (cannot be used with range in same command)"
    },
    {
      "name": "remove",
      "syntax": "remove",
      "description": "Remove group name from all slots for ALL contacts (cannot be used with range in same command)"
    },
    {
      "name": "mechanical",
      "syntax": "mechanical",
      "description": "Apply to mechanical contacts (default behavior)"
    },
    {
      "name": "thermal",
      "syntax": "thermal",
      "description": "Apply to thermal contacts (instead of mechanical)"
    }
  ],
  "examples": [
    {
      "command": "contact group 'Lining' range cylinder end-1 (16.0,-6.0,6.0) end-2 (16.0,6.0,6.0) radius 4.0",
      "description": "Assign 'Lining' group to contacts within cylindrical region (from Shallow Foundation example)",
      "use_case": "Identify lining contacts for boundary conditions"
    },
    {
      "command": "contact group 'glued' range plane dip 90 dip-direction 90 origin -6.5 0.5 24.5 dist 0.01 position-z 15 100",
      "description": "Assign 'glued' group to contacts near planar surface (from Flying Buttresses example)",
      "use_case": "Mark contacts that should have special behavior (e.g., fixed)"
    },
    {
      "command": "contact group 'boundary' range contact type 'ball-facet'",
      "description": "Assign all ball-wall contacts to 'boundary' group",
      "use_case": "Identify boundary contacts for analysis"
    },
    {
      "command": "contact group 'specimen' range ball group 'specimen'",
      "description": "Assign contacts involving balls in 'specimen' group to 'specimen' contact group",
      "use_case": "Propagate piece groups to contacts"
    },
    {
      "command": "contact group 'interface' slot 'region' range position-z 5.0 5.1",
      "description": "Assign 'interface' group to 'region' slot for contacts at z=5",
      "use_case": "Multiple classification schemes using different slots"
    },
    {
      "command": "contact group 'bonded' range model linearpbond contact bonded",
      "description": "Assign 'bonded' group to bonded contacts in default slot",
      "use_case": "Identify bonded contacts for analysis"
    },
    {
      "command": "contact group 'bonded' add",
      "description": "Assign ALL contacts to 'bonded' group in next available slot",
      "use_case": "Multiple group membership without overwriting existing groups"
    },
    {
      "command": "contact group 'temporary' remove range contact",
      "description": "Remove 'temporary' group from all contacts",
      "use_case": "Clean up temporary group assignments"
    },
    {
      "command": "contact group 'active' range contact active gap -0.1 0.0",
      "description": "Assign 'active' group to contacts that are active with slight overlap",
      "use_case": "Select contacts based on state criteria"
    }
  ],
  "python_sdk_alternative": {
    "available": true,
    "methods": [
      {
        "signature": "contact.set_group(group_name, slot=None)",
        "description": "Set contact group name in a given slot",
        "parameters": {
          "group_name": "Group name to assign (string or int)",
          "slot": "Optional slot name (defaults to 'Default')"
        },
        "example": "for c in it.contact.list(): c.set_group('boundary', 'Default')"
      },
      {
        "signature": "contact.group(slot=None)",
        "description": "Get contact group name from a given slot",
        "parameters": {
          "slot": "Optional slot name (defaults to 'Default')"
        },
        "returns": "Group name (string)",
        "example": "group_name = contact.group('Default')"
      },
      {
        "signature": "contact.group_remove(group_name, slot=None)",
        "description": "Remove contact from specified group",
        "parameters": {
          "group_name": "Group name to remove",
          "slot": "Optional slot to remove from (if None, removes from all slots)"
        },
        "returns": "True if group was removed",
        "example": "contact.group_remove('temporary')"
      },
      {
        "signature": "contact.groups()",
        "description": "Get all groups this contact belongs to",
        "returns": "Dictionary mapping slot names to group names",
        "example": "all_groups = contact.groups()  # {'Default': 'boundary', 'region': 'top'}"
      },
      {
        "signature": "contact.in_group(group_name, slot=None)",
        "description": "Test if contact is in specified group",
        "parameters": {
          "group_name": "Group name to check",
          "slot": "Optional slot to search (if None, searches all slots)"
        },
        "returns": "True if contact is in the group",
        "example": "if contact.in_group('boundary'): ..."
      }
    ],
    "notes": [
      "Python SDK requires iteration over contacts - cannot assign group to all contacts in one call",
      "Command interface is more efficient for bulk group assignment",
      "Use range specification in command interface to avoid Python iteration",
      "Python provides richer query capabilities (in_group, groups dict)"
    ],
    "command_vs_python": {
      "command": "contact group 'boundary' range contact type 'ball-facet'",
      "python": "for c in it.contact.list():\\n    if c.end1().type_id() == 'ball' and c.end2().type_id() == 'facet':\\n        c.set_group('boundary')"
    }
  },
  "related_commands": [
    "contact apply-group",
    "ball group",
    "wall group",
    "clump group",
    "contact list"
  ],
  "notes": [
    "Group names are case-sensitive strings",
    "Contacts can belong to multiple groups using different slots",
    "Default slot is 'Default' if not specified",
    "Groups enable range-based selection: 'range group <name>'",
    "Use 'add' keyword to add to next available slot for ALL contacts (cannot be combined with range)",
    "Use 'remove' keyword to remove group from all slots for ALL contacts (cannot be combined with range)",
    "More efficient than Python iteration for bulk group assignment",
    "Groups are fundamental to PFC's organizational system",
    "Group membership persists until explicitly changed or contact deleted"
  ],
  "group_slots_concept": {
    "description": "Contacts can have multiple group names assigned via different 'slots'",
    "purpose": "Allows multiple independent classification schemes for the same contacts",
    "default_slot": "'Default' - used when no slot is specified",
    "custom_slots": "Any string can be a slot name (e.g., 'boundary', 'region', 'material', 'interface')",
    "independence": "Group assignments in different slots are independent",
    "example": {
      "scenario": "A contact at specimen-platen interface",
      "slot_default": "'boundary' (indicates it's a boundary contact)",
      "slot_region": "'top' (indicates it's at top of specimen)",
      "slot_interface": "'specimen-platen' (indicates interface type)",
      "access": "Can select by any of these classifications"
    },
    "benefits": [
      "Multiple classification schemes simultaneously",
      "No need to choose between different categorizations",
      "Organize model complexity",
      "Different slots for different analysis purposes"
    ]
  },
  "slot_vs_add_vs_remove": {
    "default_behavior": {
      "command": "contact group 'boundary' range ...",
      "slot_used": "'Default'",
      "effect": "Assigns 'boundary' to 'Default' slot, overwrites previous 'Default' slot group"
    },
    "slot_keyword": {
      "command": "contact group 'top' slot 'region' range ...",
      "slot_used": "'region' (custom slot)",
      "effect": "Assigns 'top' to 'region' slot, 'Default' slot unaffected"
    },
    "add_keyword": {
      "command": "contact group 'bonded' add",
      "slot_used": "Next available slot (automatically chosen)",
      "effect": "Assigns 'bonded' to first empty slot for ALL contacts, existing groups preserved. Cannot be combined with range"
    },
    "remove_keyword": {
      "command": "contact group 'temporary' remove range ...",
      "slots_affected": "All slots",
      "effect": "Removes 'temporary' from all slots where it appears"
    }
  },
  "common_use_cases": [
    {
      "use_case": "Identify boundary contacts",
      "workflow": [
        "1. Identify boundary contacts by type: contact group 'boundary' range contact type 'ball-facet'",
        "2. All ball-wall contacts now in 'boundary' group",
        "3. Can apply boundary conditions: contact fix on range group 'boundary'",
        "4. Can analyze separately: contact result sum force range group 'boundary'"
      ],
      "notes": "Fundamental for boundary condition application"
    },
    {
      "use_case": "Organize by spatial region",
      "workflow": [
        "1. Top region: contact group 'top' slot 'region' range position-z 8 10",
        "2. Middle region: contact group 'middle' slot 'region' range position-z 3 8",
        "3. Bottom region: contact group 'bottom' slot 'region' range position-z 0 3",
        "4. Can select any region: range group 'top' slot 'region'"
      ],
      "notes": "Use custom slot 'region' to keep separate from other classifications"
    },
    {
      "use_case": "Track contact model types",
      "workflow": [
        "1. Bonded contacts: contact group 'bonded' range model linearpbond contact bonded",
        "2. Frictional contacts: contact group 'frictional' range model linear",
        "3. Can analyze by type: contact result sum force range group 'bonded'"
      ]
    },
    {
      "use_case": "Mark contacts for special treatment",
      "workflow": [
        "1. Interface contacts: contact group 'interface' range plane ... dist 0.01",
        "2. Apply special properties: contact property fric 0.1 range group 'interface'",
        "3. Or special model: contact model smoothjoint range group 'interface'"
      ],
      "notes": "Common in composite materials, layered systems"
    },
    {
      "use_case": "Multiple independent classifications",
      "workflow": [
        "1. By location: contact group 'top' slot 'region' range position-z 8 10",
        "2. By type: contact group 'boundary' slot 'Default' range contact type 'ball-facet'",
        "3. By interface: contact group 'specimen-platen' slot 'interface' range ball group 'specimen' contact wall group 'platen'",
        "4. Can combine: range group 'top' slot 'region' contact group 'boundary'"
      ],
      "notes": "Powerful organization for complex models"
    }
  ],
  "typical_workflow": [
    "1. Identify contacts to group based on criteria (type, location, model, etc.)",
    "2. Choose group name (descriptive string)",
    "3. Choose slot (use 'Default' or custom slot for multiple schemes)",
    "4. Execute: contact group <name> <keywords> range ...",
    "5. Contacts are now members of the group",
    "6. Use group for range selection: range group <name>",
    "7. Apply operations, queries, or analysis to grouped contacts"
  ],
  "group_based_selection": {
    "description": "Groups enable powerful range-based selection",
    "syntax": "range group <group_name>",
    "slot_specific": "range group <group_name> slot <slot_name>",
    "examples": [
      "contact delete range group 'temporary'",
      "contact property fric 0.5 range group 'boundary'",
      "contact fix on range group 'loaded' slot 'region'",
      "contact result sum force range group 'interface'"
    ],
    "benefits": [
      "Concise selection of contact subsets",
      "Readable, maintainable scripts",
      "Complex selections simplified",
      "Reusable selections across commands"
    ]
  },
  "range_specifications": {
    "description": "Range specification is REQUIRED to identify which contacts to assign to group",
    "common_ranges": {
      "contact": "All contacts",
      "type <type>": "Contacts of specific type (ball-ball, ball-facet, etc.)",
      "model <model>": "Contacts with specific contact model",
      "ball group <name>": "Contacts involving balls in specified group",
      "wall group <name>": "Contacts involving walls in specified group",
      "position-x/y/z <min> <max>": "Contacts in spatial range",
      "plane ...": "Contacts near planar surface",
      "cylinder ...": "Contacts in cylindrical region",
      "contact gap <min> <max>": "Contacts with gap in range",
      "contact active": "Only active contacts",
      "contact bonded": "Only bonded contacts"
    },
    "examples": [
      "contact group 'boundary' range contact type 'ball-facet'",
      "contact group 'top' range position-z 8 10",
      "contact group 'interface' range plane dip 0 origin 0 0 5 dist 0.1"
    ]
  },
  "performance_considerations": {
    "command_interface": "Very fast - bulk group assignment in C++ core",
    "python_iteration": "Slower - Python loop overhead + method call per contact",
    "recommendation": "Use command interface for bulk assignment, Python for conditional/selective assignment",
    "memory": "Group names are strings - minimal memory overhead",
    "query_performance": "Group-based range selection is optimized, very fast"
  },
  "warnings": [
    {
      "type": "slot_overwriting",
      "message": "Assigning to same slot overwrites previous group name in that slot",
      "severity": "LOW",
      "example": "contact group 'A' range ... then contact group 'B' range ... → second overwrites 'A' in Default slot",
      "mitigation": "Use different slots to preserve multiple groups with range: contact group <name> slot <slot> range ..."
    },
    {
      "type": "case_sensitive",
      "message": "Group names are case-sensitive: 'Boundary' ≠ 'boundary'",
      "severity": "LOW",
      "mitigation": "Be consistent with naming convention (e.g., all lowercase)"
    },
    {
      "type": "range_required",
      "message": "Range specification is REQUIRED - command will error without range",
      "severity": "LOW",
      "mitigation": "Always provide range, even 'range contact' for all contacts"
    }
  ],
  "troubleshooting": [
    {
      "issue": "Group assignment not working",
      "solutions": [
        "Verify range specification targets correct contacts",
        "Use 'contact list range ...' to check which contacts match range",
        "Check group name spelling (case-sensitive)",
        "Verify contacts exist in specified range"
      ]
    },
    {
      "issue": "Group disappeared after reassignment",
      "solutions": [
        "Assigning to same slot overwrites previous group",
        "Use 'add' keyword to preserve existing groups for ALL contacts: contact group <name> add (cannot be combined with range)",
        "Or use different slots with range: contact group <name> slot <slot> range ...",
        "Check if using same slot unintentionally"
      ]
    },
    {
      "issue": "Cannot select contacts by group",
      "solutions": [
        "Check group name spelling in selection: range group <name>",
        "Verify group was assigned: use Python contact.group() to check",
        "Check if using correct slot: range group <name> slot <slot>",
        "Use 'contact list range group <name>' to verify group membership"
      ]
    },
    {
      "issue": "Want to remove group from contacts",
      "solutions": [
        "Use remove keyword: contact group <name> remove range ...",
        "Or overwrite with empty: may need to delete/recreate contacts",
        "Or use Python: contact.group_remove(<name>)"
      ]
    },
    {
      "issue": "Need to check which groups a contact belongs to",
      "solutions": [
        "Python: contact.groups() returns dict of all groups",
        "Python: contact.group('Default') returns group in specific slot",
        "Python: contact.in_group('boundary') checks membership",
        "Use 'contact list' command to see group assignments"
      ]
    }
  ],
  "group_vs_apply_group": {
    "contact_group": {
      "function": "Assign group names TO contacts",
      "direction": "User → Contact",
      "command": "contact group <name> range ...",
      "example": "contact group 'boundary' range contact type 'ball-facet'",
      "result": "Contacts have group name"
    },
    "contact_apply_group": {
      "function": "Propagate group names FROM contacts TO pieces/bodies",
      "direction": "Contact → Piece/Body",
      "command": "contact apply-group",
      "example": "contact apply-group",
      "result": "Pieces/bodies get group names from contacts"
    },
    "typical_sequence": [
      "1. Assign groups to contacts: contact group 'boundary' range contact type 'ball-facet'",
      "2. Propagate to pieces: contact apply-group",
      "3. Both contacts and pieces now have 'boundary' group"
    ]
  },
  "advanced_usage": {
    "hierarchical_organization": {
      "description": "Use multiple slots for hierarchical classification",
      "example": [
        "# Level 1: Material type in 'material' slot",
        "contact group 'soil' slot 'material' range ball group 'soil'",
        "",
        "# Level 2: Region in 'region' slot",
        "contact group 'foundation' slot 'region' range position-z 0 5",
        "",
        "# Level 3: Boundary type in 'Default' slot",
        "contact group 'loaded' range contact type 'ball-facet'",
        "",
        "# Can combine: range group 'soil' slot 'material' contact group 'foundation' slot 'region'"
      ]
    },
    "dynamic_group_management": {
      "description": "Update groups during simulation based on changing conditions",
      "example": [
        "# Initial grouping",
        "contact group 'intact' range contact bonded",
        "",
        "# After some cycles, regroup based on bond state",
        "contact group 'intact' remove range contact",
        "contact group 'intact' range contact bonded",
        "contact group 'fractured' range contact not bonded"
      ]
    },
    "complex_geometric_selection": {
      "description": "Use plane and cylinder ranges for complex geometries",
      "example": [
        "# Contacts near inclined plane",
        "contact group 'interface' range plane dip 30 dip-direction 45 origin 5 5 0 dist 0.1",
        "",
        "# Contacts in cylindrical region",
        "contact group 'core' range cylinder end-1 0 0 0 end-2 0 0 10 radius 2"
      ]
    }
  },
  "best_practices": [
    "Use descriptive, meaningful group names",
    "Establish naming convention (e.g., lowercase, underscore-separated)",
    "Document group assignments in simulation scripts",
    "Use custom slots for multiple independent classification schemes",
    "Use 'add' keyword when assigning ALL contacts to multiple group memberships (no range)",
    "Verify group assignments with 'contact list' before using",
    "Use group-based selection to simplify range specifications",
    "Clean up temporary groups with 'remove' keyword when done"
  ],
  "mechanical_vs_thermal_contacts": {
    "mechanical": {
      "description": "Default contact type for force transmission",
      "command": "contact group <name> (default) or contact group <name> mechanical range ...",
      "use_case": "Standard DEM simulations"
    },
    "thermal": {
      "description": "Thermal contacts for heat transfer",
      "command": "contact group <name> thermal range ...",
      "use_case": "Coupled thermo-mechanical simulations",
      "note": "Only relevant if thermal process is active"
    }
  },
  "groups_documentation_reference": {
    "description": "Groups are a fundamental PFC concept used throughout the software",
    "general_group_logic": "See PFC documentation section 'Groups' for comprehensive information",
    "applies_to": [
      "balls",
      "walls",
      "clumps",
      "contacts",
      "facets",
      "pebbles"
    ],
    "universal_concepts": [
      "Group slots for multiple classifications",
      "Group-based range selection",
      "Group propagation between entities",
      "Case-sensitive group names"
    ]
  }
}
