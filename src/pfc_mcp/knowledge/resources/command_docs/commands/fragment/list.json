{
  "command": "fragment list",
  "category": "fragment",
  "search_keywords": ["list", "query"],
  "description": "List fragment information. By default, lists fragment catalog information (catalog number, cycle, time, and fragment count). Use the catalog keyword to list all fragments at a specific catalog number, or the id keyword to list the complete history of a specific fragment.",

  "syntax": "fragment list <keyword>",

  "keywords": [
    {
      "name": "catalog",
      "syntax": "catalog <i>",
      "description": "List the fragment information of all active fragments in catalog i. Includes fragment ID, volume, body count, and position for each fragment.",
      "required": false,
      "parameters": [
        {
          "name": "i",
          "type": "integer",
          "required": true,
          "description": "Catalog number to list fragments from"
        }
      ]
    },
    {
      "name": "id",
      "syntax": "id <i>",
      "description": "List the catalog numbers, cycle numbers, times, volumes, body counts, and positions of the fragment with ID i throughout its history.",
      "required": false,
      "parameters": [
        {
          "name": "i",
          "type": "integer",
          "required": true,
          "description": "Fragment ID to trace through history"
        }
      ]
    }
  ],

  "notes": [
    "Default (no keywords): Lists catalog overview - all catalog numbers with cycle, time, and fragment count",
    "catalog <i>: Lists all fragments in a specific catalog - detailed snapshot",
    "id <i>: Lists complete history of a specific fragment - evolution tracking",
    "Catalog number increments each time fragments are computed",
    "Fragment ID is unique within a catalog but may change between catalogs",
    "Volume is the total volume of all bodies in the fragment",
    "Body count is the number of balls/clumps in the fragment",
    "Position is the centroid of the fragment (average position of bodies)",
    "Requires fragment persistence (persist true) for historical data"
  ],

  "examples": [
    {
      "command": "fragment list",
      "description": "List all catalog entries (overview of all fragment computations)",
      "use_case": "See when fragments were computed and how many existed at each time",
      "output_example": "Catalog 1: Cycle 0, Time 0.0, 10 fragments\nCatalog 2: Cycle 1000, Time 0.1, 15 fragments"
    },
    {
      "command": "fragment list catalog 1",
      "description": "List all fragments in catalog 1 (detailed snapshot at that computation)",
      "use_case": "Examine specific fragment configuration at a particular moment",
      "output_example": "Fragment 1: Volume 0.05, Bodies 5, Position (1.0, 2.0, 0.0)\nFragment 2: Volume 0.08, Bodies 8, Position (5.0, 3.0, 0.0)"
    },
    {
      "command": "fragment list id 1",
      "description": "List complete history of fragment 1 across all catalogs",
      "use_case": "Track how a specific fragment evolved over time",
      "output_example": "Catalog 1: Cycle 0, Time 0.0, Volume 0.05, Bodies 5\nCatalog 2: Cycle 1000, Time 0.1, Volume 0.06, Bodies 6"
    },
    {
      "command": "fragment compute\nfragment list\nmodel cycle 1000\nfragment compute\nfragment list",
      "description": "Compute, list, run cycles, recompute, list again to compare",
      "use_case": "Track fragment evolution between two simulation states"
    },
    {
      "command": "fragment activate cycles 100\nmodel cycle 5000\nfragment list",
      "description": "Auto-compute during cycling, then list all catalog entries",
      "use_case": "See complete history of fragment evolution during auto-computation"
    },
    {
      "command": "fragment list\nfragment list catalog 5\nfragment list id 3",
      "description": "Overview, then specific catalog detail, then specific fragment history",
      "use_case": "Progressive drill-down into fragment data"
    }
  ],

  "python_sdk_alternative": {
    "available": false,
    "notes": [
      "No direct Python SDK method for fragment list output",
      "Must use command interface: itasca.command('fragment list')",
      "Can query individual fragment IDs: ball.fragment(), clump.fragment()",
      "Can build custom Python analysis iterating over bodies",
      "fragment list provides formatted output, Python gives programmatic access"
    ],
    "command_vs_python": {
      "command": "fragment list catalog 1",
      "python": "# No direct equivalent - must iterate:\nfragments = {}\nfor b in it.ball.list():\n    fid = b.fragment()\n    if fid not in fragments:\n        fragments[fid] = []\n    fragments[fid].append(b)"
    }
  },

  "related_commands": [
    "fragment compute",
    "fragment activate",
    "fragment register",
    "fragment clear"
  ],

  "common_use_cases": [
    {
      "use_case": "Check fragment computation results",
      "workflow": [
        "1. Compute fragments: fragment compute",
        "2. List results: fragment list",
        "3. View overview: see catalog number, cycle, time, fragment count",
        "4. Drill down if needed: fragment list catalog <i>"
      ],
      "notes": "Basic workflow for verifying fragment computation"
    },
    {
      "use_case": "Track fragment evolution during simulation",
      "workflow": [
        "1. Activate auto-computation: fragment activate cycles 100",
        "2. Run simulation: model cycle 10000",
        "3. List all catalogs: fragment list",
        "4. Shows how fragment count changed over time",
        "5. Drill down to specific moments: fragment list catalog <i>"
      ],
      "notes": "Understand how fragments evolve during loading, fracture, etc."
    },
    {
      "use_case": "Analyze specific fragment history",
      "workflow": [
        "1. Identify fragment of interest (e.g., largest fragment)",
        "2. List its history: fragment list id <fragment_id>",
        "3. See how it grew/shrank over catalogs",
        "4. Track volume, body count, position changes"
      ],
      "notes": "Study individual fragment evolution"
    },
    {
      "use_case": "Compare fragment states at different times",
      "workflow": [
        "1. List all catalogs: fragment list",
        "2. Identify interesting catalogs (e.g., before and after fracture)",
        "3. List catalog A: fragment list catalog <A>",
        "4. List catalog B: fragment list catalog <B>",
        "5. Compare fragment configurations"
      ],
      "notes": "Before/after comparison for fracture analysis"
    }
  ],

  "typical_workflow": [
    "1. Compute fragments: fragment compute or fragment activate",
    "2. List overview: fragment list (see all catalogs)",
    "3. Examine specific catalog: fragment list catalog <i>",
    "4. Track specific fragment: fragment list id <fragment_id>",
    "5. Export or analyze data as needed"
  ],

  "three_list_modes": {
    "default_mode": {
      "command": "fragment list",
      "output": "Catalog overview - all catalog entries",
      "includes": ["Catalog number", "Cycle number", "Time", "Fragment count"],
      "use_when": "Want to see overall fragment computation history",
      "example_output": "Catalog 1: Cycle 0, Time 0.0, 10 fragments\nCatalog 2: Cycle 1000, Time 0.1, 12 fragments\nCatalog 3: Cycle 2000, Time 0.2, 15 fragments"
    },
    "catalog_mode": {
      "command": "fragment list catalog <i>",
      "output": "Detailed fragment information for catalog i",
      "includes": ["Fragment ID", "Volume", "Body count", "Position (x,y,z)"],
      "use_when": "Want detailed snapshot of fragments at specific moment",
      "example_output": "Fragment 1: Volume 0.05, Bodies 5, Position (1.0, 2.0, 0.0)\nFragment 2: Volume 0.08, Bodies 8, Position (5.0, 3.0, 0.0)"
    },
    "id_mode": {
      "command": "fragment list id <i>",
      "output": "Complete history of fragment i",
      "includes": ["Catalog numbers", "Cycle numbers", "Times", "Volumes", "Body counts", "Positions"],
      "use_when": "Want to track evolution of specific fragment",
      "example_output": "Catalog 1: Cycle 0, Time 0.0, Volume 0.05, Bodies 5, Position (1.0, 2.0, 0.0)\nCatalog 2: Cycle 1000, Time 0.1, Volume 0.06, Bodies 6, Position (1.1, 2.0, 0.0)"
    }
  },

  "catalog_concept": {
    "description": "Understanding fragment catalogs",
    "what_is_catalog": "A snapshot of fragment configuration at a specific moment",
    "when_created": "Each time fragment compute or auto-computation runs",
    "catalog_number": "Sequential identifier starting from 1",
    "contains": [
      "All fragment IDs at that moment",
      "Each fragment's properties (volume, body count, position)",
      "Associated cycle number and time"
    ],
    "catalog_vs_fragment_id": {
      "catalog": "Snapshot identifier - when was this computed?",
      "fragment_id": "Fragment identifier - which cluster of bodies?"
    },
    "example": "Catalog 1 at cycle 0 might have fragments 1,2,3,4,5; Catalog 2 at cycle 1000 might have fragments 1,2,3,4,5,6 (new fragment formed)"
  },

  "fragment_id_meaning": {
    "description": "Understanding fragment IDs in list output",
    "within_catalog": "Fragment IDs are unique and sequential within a catalog",
    "across_catalogs": "Same fragment ID in different catalogs may represent different physical fragments",
    "tracking_fragments": "Use 'fragment list id <i>' to track how a specific fragment evolves",
    "id_assignment": "IDs assigned based on fragment detection algorithm (connected components)",
    "id_0_meaning": "Fragment ID 0 typically means isolated body (no contacts)",
    "example": "Fragment 1 in catalog 1 and fragment 1 in catalog 2 may be the same physical cluster, or different - use 'id' mode to trace"
  },

  "volume_body_count_position": {
    "volume": {
      "description": "Total volume of all bodies in the fragment",
      "calculated_as": "Sum of individual body volumes",
      "units": "Model length units cubed",
      "use": "Indicate fragment size, compare relative sizes"
    },
    "body_count": {
      "description": "Number of bodies (balls/clumps) in the fragment",
      "use": "Simple size metric, count particles in cluster"
    },
    "position": {
      "description": "Centroid of the fragment",
      "calculated_as": "Average position of all bodies in fragment (volume-weighted or body-count-weighted)",
      "use": "Locate fragment in space, track fragment motion"
    }
  },

  "interpreting_output": {
    "default_output": {
      "format": "Catalog <num>: Cycle <cycle>, Time <time>, <count> fragments",
      "interpretation": [
        "Shows when fragments were computed",
        "How many fragments existed at each computation",
        "Useful for tracking fragment count evolution"
      ],
      "example": "Catalog 1: Cycle 0, Time 0.0, 10 fragments - means at cycle 0, 10 fragments detected"
    },
    "catalog_output": {
      "format": "Fragment <id>: Volume <vol>, Bodies <count>, Position (<x>, <y>, <z>)",
      "interpretation": [
        "Detailed information for each fragment in catalog",
        "Can identify largest fragment (by volume or body count)",
        "Can locate fragments spatially"
      ],
      "example": "Fragment 1: Volume 0.05, Bodies 5, Position (1.0, 2.0, 0.0) - fragment 1 has 5 bodies with total volume 0.05 centered at (1.0, 2.0, 0.0)"
    },
    "id_output": {
      "format": "Catalog <num>: Cycle <cycle>, Time <time>, Volume <vol>, Bodies <count>, Position (<x>, <y>, <z>)",
      "interpretation": [
        "Shows how fragment properties changed over time",
        "Growing volume/body count = fragment merging or body addition",
        "Moving position = fragment translation",
        "Missing from later catalogs = fragment disappeared"
      ],
      "example": "Catalog 1: Volume 0.05, Bodies 5\nCatalog 2: Volume 0.08, Bodies 8 - fragment grew from 5 to 8 bodies"
    }
  },

  "persistence_requirement": {
    "description": "Fragment list depends on fragment persistence setting",
    "persist_true": {
      "list_behavior": "Full catalog history available",
      "catalog_mode": "Can list any catalog from history",
      "id_mode": "Can trace fragment history across catalogs",
      "note": "This is the default and typical mode"
    },
    "persist_false": {
      "list_behavior": "Only current state available",
      "catalog_mode": "Only most recent catalog available",
      "id_mode": "Limited or no historical tracking",
      "note": "Faster computation but no history"
    },
    "recommendation": "Use persist true (default) if you need fragment list for analysis"
  },

  "analysis_workflows": {
    "identify_largest_fragment": {
      "workflow": [
        "1. fragment list catalog <current>",
        "2. Scan output for largest volume or body count",
        "3. Note fragment ID of largest",
        "4. Optionally: fragment list id <largest_id> to see its history"
      ]
    },
    "count_fragments_over_time": {
      "workflow": [
        "1. fragment list (default mode)",
        "2. Extract fragment count from each catalog",
        "3. Plot fragment count vs. cycle or time",
        "4. Analyze fragmentation evolution"
      ]
    },
    "track_fragment_splitting": {
      "workflow": [
        "1. fragment list catalog <early>",
        "2. Note large fragment (e.g., fragment 1 with 100 bodies)",
        "3. fragment list catalog <later>",
        "4. If fragment 1 now has 40 bodies, it likely split",
        "5. New fragments in later catalog may be the split portions"
      ]
    },
    "measure_fragment_displacement": {
      "workflow": [
        "1. fragment list id <fragment_id>",
        "2. Note position in early catalog: (x1, y1, z1)",
        "3. Note position in later catalog: (x2, y2, z2)",
        "4. Calculate displacement: sqrt((x2-x1)^2 + (y2-y1)^2 + (z2-z1)^2)"
      ]
    }
  },

  "performance_considerations": {
    "default_list": "Very fast - just lists catalog metadata",
    "catalog_list": "Moderate - must retrieve all fragment data for that catalog",
    "id_list": "Moderate - must search through history for specific fragment",
    "large_models": "Listing many fragments may produce very long output",
    "recommendation": "Use default list first, then drill down to specific catalogs/IDs as needed"
  },

  "warnings": [
    {
      "type": "persistence_required",
      "message": "Fragment history requires persist true - persist false limits list functionality",
      "severity": "MEDIUM",
      "mitigation": "Use persist true (default) if you need comprehensive fragment list output"
    },
    {
      "type": "fragment_id_not_unique_across_catalogs",
      "message": "Fragment ID may represent different physical fragments in different catalogs",
      "severity": "MEDIUM",
      "mitigation": "Use 'fragment list id <i>' to trace specific fragment history, don't assume ID consistency"
    },
    {
      "type": "large_output",
      "message": "Large models with many fragments may produce very long list output",
      "severity": "LOW",
      "mitigation": "Consider redirecting output to file, or use Python for programmatic analysis"
    },
    {
      "type": "no_fragments_computed",
      "message": "If fragments never computed, list will be empty or show no catalogs",
      "severity": "LOW",
      "mitigation": "Call fragment compute or fragment activate before fragment list"
    }
  ],

  "troubleshooting": [
    {
      "issue": "fragment list shows no catalogs",
      "solutions": [
        "Fragments were never computed - call fragment compute or fragment activate",
        "fragment register may not have been called",
        "Verify fragment tracking was initialized properly",
        "Check that model has contacts and fragments can form"
      ]
    },
    {
      "issue": "fragment list catalog <i> shows no fragments",
      "solutions": [
        "Catalog number may not exist - check default fragment list for valid catalog numbers",
        "All bodies may be isolated (fragment ID 0) at that catalog",
        "Fragment computation may have failed at that moment",
        "Verify catalog number is correct"
      ]
    },
    {
      "issue": "fragment list id <i> shows no history",
      "solutions": [
        "Fragment ID may not exist in any catalog",
        "Fragment may have existed only briefly (appeared and disappeared)",
        "Verify fragment ID is correct - use fragment list catalog to see valid IDs",
        "Fragment may be isolated (ID 0) which may not be tracked"
      ]
    },
    {
      "issue": "Fragment ID seems to disappear between catalogs",
      "solutions": [
        "Fragment may have merged with another fragment",
        "Fragment may have been deleted (e.g., bodies deleted)",
        "Fragment may have fallen apart (split into smaller fragments)",
        "This is normal behavior - fragments evolve over time"
      ]
    },
    {
      "issue": "Fragment properties changing unexpectedly",
      "solutions": [
        "This is expected - fragments evolve as contacts form/break",
        "Volume changes: bodies added/removed or body volumes changed",
        "Body count changes: fragment merging/splitting",
        "Position changes: fragment moving in space",
        "Use id mode to trace evolution and understand changes"
      ]
    }
  ],

  "output_redirection": {
    "description": "Managing fragment list output",
    "screen_output": "Default - prints to console",
    "file_output": "Can redirect to file for post-processing",
    "example": "fragment list > fragments.txt (OS-dependent syntax)",
    "python_parsing": "Can parse output with Python string processing",
    "alternative": "Use Python SDK to programmatically access fragment data instead of parsing text output"
  },

  "fragment_list_vs_python": {
    "fragment_list": {
      "pros": [
        "Quick overview of fragment configuration",
        "Formatted output easy to read",
        "Shows historical data if persist true"
      ],
      "cons": [
        "Text output - may need parsing for analysis",
        "Large output for many fragments"
      ],
      "use_when": "Quick inspection, verification, or manual analysis"
    },
    "python_iteration": {
      "pros": [
        "Programmatic access to fragment IDs",
        "Can compute custom statistics",
        "Flexible analysis and filtering"
      ],
      "cons": [
        "Must write code to analyze",
        "No historical data (only current state)",
        "Slower than built-in fragment list"
      ],
      "use_when": "Automated analysis, custom statistics, integration with other code",
      "example": "for b in it.ball.list():\n    frag_id = b.fragment()\n    # process fragment ID"
    }
  },

  "catalog_number_meaning": {
    "description": "What catalog numbers represent",
    "numbering": "Sequential integers starting from 1",
    "increment": "Each fragment compute or auto-computation creates new catalog",
    "association": "Each catalog associated with specific cycle and time",
    "use": "Identify when fragment configuration was captured",
    "example": "Catalog 1: initial state, Catalog 10: after 900 cycles (if auto-compute every 100 cycles)"
  }
}
