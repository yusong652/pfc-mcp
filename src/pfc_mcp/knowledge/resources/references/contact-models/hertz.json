{
  "model": "hertz",
  "full_name": "Hertz Model",
  "search_keywords": ["hertz", "contact", "model"],
  "description": "Hertz contact model implements a nonlinear formulation based on an approximation of the theory of Mindlin and Deresiewicz. Unlike linear models with constant stiffnesses, the Hertz model produces nonlinear force-displacement relationships through elastic sphere deformation analysis. Normal force follows F_n^h = -h_n|g_c|^(α_h) where α_h defaults to 1.5, and shear stiffness depends on current normal force, making the contact response highly nonlinear and velocity-dependent.",

  "typical_applications": [
    "Impact simulations",
    "Energy dissipation analysis",
    "More realistic contact mechanics",
    "Scenarios requiring nonlinear elasticity",
    "Material systems where Hertzian contact theory applies",
    "Coaxial cylinder contact problems"
  ],

  "key_characteristics": [
    "Nonlinear force-displacement relationships (unlike linear model)",
    "Normal force: F_n^h = -h_n|g_c|^(α_h), default α_h = 1.5",
    "Shear stiffness depends dynamically on current normal force",
    "Based on Mindlin-Deresiewicz theory of elastic sphere deformation",
    "Uses shear modulus (G) and Poisson's ratio (ν) instead of direct stiffnesses",
    "Contact response is velocity-dependent through dashpot damping",
    "Complex property inheritance through effective elastic properties",
    "Suitable for impact and energy dissipation scenarios"
  ],

  "property_groups": [
    {
      "name": "Hertz Group",
      "description": "Hertzian nonlinear elastic contact properties",
      "properties": [
        {
          "keyword": "rgap",
          "symbol": "g_r",
          "description": "Reference gap [length]",
          "type": "FLT",
          "range": "ℝ",
          "default": "0.0",
          "modifiable": true,
          "inheritable": false,
          "notes": "Reference surface gap. Used to define initial contact configuration. Typically 0.0 for initially touching contacts."
        },
        {
          "keyword": "hz_shear",
          "symbol": "G",
          "description": "Shear modulus [stress]",
          "type": "FLT",
          "range": "[0.0, +∞)",
          "default": "0.0",
          "modifiable": true,
          "inheritable": true,
          "notes": "Shear modulus of the material. Fundamental material property (unlike linear model's stiffness). Typical values: 1e9 - 1e11 Pa for rocks, 1e7 - 1e9 Pa for soils. Inheritance uses Mindlin-Deresiewicz effective modulus: G* = ((2-ν₁)/G₁ + (2-ν₂)/G₂)⁻¹, then G = 2G*(2-ν)."
        },
        {
          "keyword": "hz_poiss",
          "symbol": "ν",
          "description": "Poisson's ratio [-]",
          "type": "FLT",
          "range": "(-1.0, 0.5]",
          "default": "0.0",
          "modifiable": true,
          "inheritable": true,
          "notes": "Poisson's ratio of the material. Fundamental material property. Typical values: 0.2 - 0.35 for most materials. Must be > -1.0 and ≤ 0.5. Inheritance uses Mindlin-Deresiewicz: E* and G* computed from both pieces, then ν = (4G* - E*)/(2G* - E*)."
        },
        {
          "keyword": "fric",
          "symbol": "μ",
          "description": "Friction coefficient [-]",
          "type": "FLT",
          "range": "[0.0, +∞)",
          "default": "0.0",
          "modifiable": true,
          "inheritable": true,
          "notes": "Coulomb friction coefficient. Shear force limited by friction. Value of 0.0 means frictionless contact. Inheritance uses minimum: fric = min(fric(1), fric(2))."
        },
        {
          "keyword": "hz_mode",
          "symbol": "M_s",
          "description": "Shear-force scaling mode [-]",
          "type": "INT",
          "range": "{0, 1}",
          "default": "0",
          "modifiable": true,
          "inheritable": false,
          "notes": "Controls how shear stiffness scales with normal force. Affects nonlinear shear response.",
          "values": [
            {
              "value": 0,
              "description": "Standard scaling mode"
            },
            {
              "value": 1,
              "description": "Alternative scaling mode"
            }
          ]
        },
        {
          "keyword": "hz_alpha",
          "symbol": "α_h",
          "description": "Exponent [-]",
          "type": "FLT",
          "range": "[0.0, +∞)",
          "default": "1.5",
          "modifiable": true,
          "inheritable": false,
          "notes": "Exponent in nonlinear force-displacement relationship: F_n^h = -h_n|g_c|^(α_h). Default 1.5 is for Hertzian sphere-sphere contact. Use 1.0-1.5 for coaxial cylinders. Controls degree of nonlinearity."
        },
        {
          "keyword": "hz_slip",
          "symbol": "s",
          "description": "Slip state [-]",
          "type": "BOOL",
          "range": "{false, true}",
          "default": "false",
          "modifiable": false,
          "inheritable": "N/A",
          "notes": "Read-only state indicator. True when contact is slipping (shear force at friction limit), false when not slipping.",
          "values": [
            {
              "value": true,
              "description": "slipping - shear force at friction limit"
            },
            {
              "value": false,
              "description": "not slipping - shear force below friction limit"
            }
          ]
        },
        {
          "keyword": "hz_force",
          "symbol": "F^h",
          "description": "Hertz force (contact plane coordinate system) [force]",
          "type": "VEC",
          "range": "ℝ³",
          "default": "0",
          "modifiable": true,
          "inheritable": false,
          "notes": "Nonlinear elastic force vector in contact plane coordinates: (-F_n^h, F_ss^h, F_st^h). In 2D models: F_ss^h ≡ 0. Negative normal component indicates compression. Normal force is nonlinear in overlap.",
          "components": {
            "2D": "(-F_n^h, F_st^h)",
            "3D": "(-F_n^h, F_ss^h, F_st^h)"
          }
        }
      ]
    },
    {
      "name": "Dashpot Group",
      "description": "Velocity-dependent damping for energy dissipation in Hertz model",
      "properties": [
        {
          "keyword": "dp_nratio",
          "symbol": "β_n",
          "description": "Normal critical damping ratio [-]",
          "type": "FLT",
          "range": "[0.0, 1.0]",
          "default": "0.0",
          "modifiable": true,
          "inheritable": false,
          "notes": "Normal direction damping as fraction of critical damping. 0.0 = no damping, 1.0 = critical damping. Essential for impact simulations to dissipate energy."
        },
        {
          "keyword": "dp_sratio",
          "symbol": "β_s",
          "description": "Shear critical damping ratio [-]",
          "type": "FLT",
          "range": "[0.0, 1.0]",
          "default": "0.0",
          "modifiable": true,
          "inheritable": false,
          "notes": "Shear direction damping as fraction of critical damping. 0.0 = no damping, 1.0 = critical damping. Important for energy dissipation in dynamic simulations."
        },
        {
          "keyword": "dp_alpha",
          "symbol": "α_d",
          "description": "Dashpot exponent [-]",
          "type": "FLT",
          "range": "[0.0, +∞)",
          "default": "0.0",
          "modifiable": true,
          "inheritable": false,
          "notes": "Exponent for nonlinear dashpot behavior. Default 0.0 gives linear viscous damping. Non-zero values create nonlinear velocity-dependent damping."
        },
        {
          "keyword": "dp_mode",
          "symbol": "M_d",
          "description": "Dashpot mode [-]",
          "type": "INT",
          "range": "{0, 1, 2, 3}",
          "default": "0",
          "modifiable": true,
          "inheritable": false,
          "notes": "Controls when dashpot forces are active.",
          "values": [
            {
              "value": 0,
              "description": "full normal & full shear - damping always active"
            },
            {
              "value": 1,
              "description": "no-tension normal & full shear - no normal damping in tension"
            },
            {
              "value": 2,
              "description": "full normal & slip-cut shear - no shear damping when slipping"
            },
            {
              "value": 3,
              "description": "no-tension normal & slip-cut shear - combined restrictions"
            }
          ]
        },
        {
          "keyword": "dp_force",
          "symbol": "F^d",
          "description": "Dashpot force (contact plane coordinate system) [force]",
          "type": "VEC",
          "range": "ℝ³",
          "default": "0",
          "modifiable": false,
          "inheritable": false,
          "notes": "Read-only dashpot force vector in contact plane coordinates: (-F_n^d, F_ss^d, F_st^d). In 2D models: F_ss^d ≡ 0. Automatically calculated based on dp_nratio, dp_sratio, dp_alpha, and dp_mode.",
          "components": {
            "2D": "(-F_n^d, F_st^d)",
            "3D": "(-F_n^d, F_ss^d, F_st^d)"
          }
        }
      ]
    }
  ],

  "energy_partitions": [
    {
      "name": "energy-strain",
      "symbol": "E_k",
      "description": "Strain energy stored in nonlinear Hertzian springs",
      "range": "[0.0, +∞)",
      "accumulated": false,
      "group": "Hertz Group"
    },
    {
      "name": "energy-slip",
      "symbol": "E_μ",
      "description": "Energy dissipated by frictional slip",
      "range": "(-∞, 0.0]",
      "accumulated": true,
      "group": "Hertz Group"
    },
    {
      "name": "energy-dashpot",
      "symbol": "E_β",
      "description": "Energy dissipated by velocity-dependent dashpots",
      "range": "(-∞, 0.0]",
      "accumulated": true,
      "group": "Dashpot Group"
    }
  ],

  "callback_events": [
    {
      "name": "contact_activated",
      "description": "Triggered when surface gap becomes ≤ 0 (contact initiates)",
      "use": "Monitor contact formation in dynamic simulations"
    },
    {
      "name": "slip_change",
      "description": "Triggered when slip state transitions",
      "values": [
        {
          "value": 0,
          "description": "Slip initiates (hz_slip changes from false to true)"
        },
        {
          "value": 1,
          "description": "Slip ends (hz_slip changes from true to false)"
        }
      ],
      "use": "Track sliding events and transitions"
    }
  ],

  "common_usage_patterns": [
    {
      "use_case": "Basic Hertz contact with material properties",
      "commands": [
        "contact cmat default model hertz property hz_shear 2e9 hz_poiss 0.25 fric 0.5"
      ],
      "description": "Set fundamental material properties (shear modulus and Poisson's ratio) directly. More physically meaningful than linear stiffnesses."
    },
    {
      "use_case": "Impact simulation with energy dissipation",
      "commands": [
        "contact cmat default model hertz property hz_shear 2e9 hz_poiss 0.25 fric 0.5 dp_nratio 0.5 dp_sratio 0.3"
      ],
      "description": "Add dashpot damping for velocity-dependent energy dissipation in impact scenarios."
    },
    {
      "use_case": "Custom nonlinearity exponent",
      "commands": [
        "contact cmat default model hertz property hz_shear 2e9 hz_poiss 0.25 fric 0.5 hz_alpha 1.2"
      ],
      "description": "Adjust hz_alpha for different contact geometries (e.g., coaxial cylinders use 1.0-1.5 instead of default 1.5)."
    },
    {
      "use_case": "Nonlinear dashpot damping",
      "commands": [
        "contact cmat default model hertz property hz_shear 2e9 hz_poiss 0.25 fric 0.5 dp_nratio 0.5 dp_alpha 0.5"
      ],
      "description": "Use dp_alpha > 0 for nonlinear velocity-dependent damping behavior."
    }
  ],

  "typical_parameter_values": {
    "rock_materials": {
      "hz_shear": "1e10 - 1e11 [Pa] (typical rock shear modulus)",
      "hz_poiss": "0.20 - 0.30",
      "fric": "0.5 - 0.7",
      "hz_alpha": "1.5 (default for sphere-sphere)",
      "dp_nratio": "0.3 - 0.7 for impact simulations"
    },
    "soil_materials": {
      "hz_shear": "1e7 - 1e9 [Pa] (typical soil shear modulus)",
      "hz_poiss": "0.25 - 0.35",
      "fric": "0.3 - 0.6",
      "hz_alpha": "1.5 (default)",
      "dp_nratio": "0.5 - 0.8"
    },
    "contact_geometry": {
      "sphere_sphere": "hz_alpha = 1.5 (default, Hertzian contact)",
      "coaxial_cylinders": "hz_alpha = 1.0 - 1.5",
      "other_geometries": "Adjust hz_alpha based on contact theory"
    }
  },

  "notes": [
    "Hertz model is NONLINEAR - forces depend on overlap raised to power hz_alpha (default 1.5)",
    "Normal force: F_n^h = -h_n|g_c|^(α_h) where g_c is surface gap",
    "Shear stiffness depends dynamically on current normal force (unlike linear model)",
    "Uses material properties (G, ν) instead of direct stiffnesses (kn, ks)",
    "hz_shear and hz_poiss inherit through complex averaging from contacting pieces",
    "Friction coefficient uses MINIMUM value from contacting surfaces",
    "Default hz_alpha = 1.5 is for Hertzian sphere-sphere contact",
    "Adjust hz_alpha for different contact geometries (1.0-1.5 for cylinders)",
    "Dashpot damping is essential for impact simulations to dissipate energy",
    "dp_alpha allows nonlinear velocity-dependent damping (default 0.0 = linear)",
    "Contact response is inherently velocity-dependent",
    "More computationally expensive than linear model due to nonlinearity"
  ],

  "hertzian_contact_theory": {
    "concept": "Hertz contact theory describes the elastic deformation when two curved surfaces come into contact. The contact area and pressure distribution are nonlinear functions of the applied force and material properties.",
    "force_displacement": "Normal force varies as F_n ~ δ^(3/2) for sphere-sphere contact, where δ is overlap. This is why default hz_alpha = 1.5.",
    "advantages_over_linear": [
      "More realistic contact mechanics",
      "Nonlinear stiffness increases with overlap (stiffens under load)",
      "Based on continuum mechanics theory",
      "Better for impact and dynamic loading scenarios",
      "Material properties (G, ν) are more fundamental than arbitrary stiffnesses"
    ],
    "disadvantages": [
      "More computationally expensive",
      "Requires careful calibration of material properties",
      "May require smaller timesteps due to nonlinearity",
      "Cannot transmit tension (purely repulsive)"
    ]
  },

  "workflow": [
    "1. Set contact model to hertz via CMAT or contact model assign",
    "2. Set material properties: hz_shear (shear modulus) and hz_poiss (Poisson's ratio)",
    "3. Set friction coefficient (fric) for sliding resistance",
    "4. Optionally adjust hz_alpha for non-spherical contact geometries",
    "5. Add dashpot damping (dp_nratio, dp_sratio) for energy dissipation in impact",
    "6. Optionally set dp_alpha for nonlinear velocity-dependent damping",
    "7. Monitor energy-dashpot to verify energy dissipation",
    "8. Use callback events (contact_activated, slip_change) for tracking"
  ],

  "comparison_to_linear_model": {
    "linear_model": {
      "force_displacement": "Linear: F = k × δ (constant stiffness)",
      "parameters": "Direct stiffnesses kn, ks",
      "behavior": "Linear elastic at all loads",
      "computational_cost": "Low",
      "physical_basis": "Phenomenological springs"
    },
    "hertz_model": {
      "force_displacement": "Nonlinear: F = h_n × |δ|^(α_h) (variable stiffness)",
      "parameters": "Material properties G, ν",
      "behavior": "Stiffens with increasing overlap",
      "computational_cost": "Higher",
      "physical_basis": "Continuum mechanics (Hertz theory)"
    },
    "when_to_use_hertz": [
      "Impact and dynamic loading scenarios",
      "When realistic contact mechanics is important",
      "When material properties G and ν are known",
      "Energy dissipation analysis",
      "High-velocity collisions"
    ],
    "when_to_use_linear": [
      "Quasi-static simulations",
      "When computational efficiency is critical",
      "When simple calibration is needed",
      "Large-scale simulations with many contacts"
    ]
  },

  "related_models": [
    {
      "model": "linear",
      "description": "Simpler alternative with constant stiffnesses - computationally cheaper"
    }
  ]
}
